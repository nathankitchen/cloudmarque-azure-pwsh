resourceGroupName,nsgName,ruleName,priority,direction,sourceIp,sourcePort,destinationIp,destinationPort,protocol,Access,Description,servicePublish,resourceGroupservicePublish, storageServiceDependency, workspaceServiceDependency
Iaas-Test-Hub1-Rg,Iaas-Test-Hub1-Vnet1-Snet-Nsg-dc1,AllowAD-UDP-Traffic-Inbound,2100,Inbound,"10.0.0.0/23,10.8.0.0/22,10.112.124.10,192.168.0.0/23,10.10.0.0/22",*,192.168.0.196,"123,137,138",UDP,Allow,"Allow Windows Time,DFS, Group Policy,Netlogon",Iaas-Test-Hub1-Vnet1-Snet-Nsg-dc1,Iaas-Test-Hub1-Rg, Core-Test-St, Core-Test-Ws
Iaas-Test-Hub1-Rg,Iaas-Test-Hub1-Vnet1-Snet-Nsg-dc1,AllowAD-TCP-Traffic-Inbound,2110,Inbound,"10.0.0.0/23,10.8.0.0/22,10.112.124.10,192.168.0.0/23,10.10.0.0/22",*,192.168.0.196,"135,139,445,636,3268,6269,49152-65535",TCP,Allow,"Allow RPC, LDAP GC, LDAP GC SSL, LDAP SSL ,SMB, User/Computer Authentication",,,,
Iaas-Test-Hub1-Rg,Iaas-Test-Hub1-Vnet1-Snet-Nsg-dc1,AllowAD-TCP-UDP-Traffic-Inbound,2120,Inbound,"10.0.0.0/23,10.8.0.0/22,10.112.124.10,192.168.0.0/23,10.10.0.0/22",*,192.168.0.196,"464,389,53,88",*,Allow,"Allow Kerberos, LDAP,DNS.",,,,
Iaas-Test-Hub1-Rg,Iaas-Test-Hub1-Vnet1-Snet-Nsg-dc1,AllowAD-TCP-UDP-Traffic-Outbound,2130,Outbound,192.168.0.196,*,"10.0.0.0/23,10.8.0.0/22,10.112.124.10,192.168.0.0/23,10.10.0.0/22",*,*,Allow,Allow AD Servers to Initiate connections to Workloads.,,,,
Iaas-Test-Hub1-Rg,Iaas-Test-Hub1-Vnet1-Snet-Nsg-dc1,AllowDNSOutbound,2140,Outbound,192.168.0.196,*,*,53,*,Allow,Allow External DNS queries,,,,
Iaas-Test-Hub1-Rg,Iaas-Test-Hub1-Vnet1-Snet-Nsg-dc1,AllowICMPInbound,2150,Inbound,"10.0.0.0/23,10.8.0.0/22,10.112.124.10,192.168.0.0/23,10.10.0.0/22",*,192.168.0.196,*,ICMP,Allow,Allow ICMP from within the vdc.,,,,
Iaas-Test-Hub1-Rg,Iaas-Test-Hub1-Vnet1-Snet-Nsg-dc1,AllowManagementprotocolsfromJumpboxesInbound,2320,Inbound,"192.168.0.96/27,10.0.0.96/27",*,"192.168.0.0/23,10.10.0.0/22,10.0.0.0/23,10.8.0.0/22","3389,22,80,443,445",*,Allow,Allow Management from Jump Server,,,,
Iaas-Test-Hub1-Rg,Iaas-Test-Hub1-Vnet1-Snet-Nsg-fwha1,AllowInboundTrafficBetweenNodes,1570,Inbound,"192.168.0.84,192.168.0.85",*,"192.168.0.84,192.168.0.85",*,*,Allow,Allow HA traffic between nodes,Iaas-Test-Hub1-Vnet1-Snet-Nsg-fwha1,,,
Iaas-Test-Hub1-Rg,Iaas-Test-Hub1-Vnet1-Snet-Nsg-fwha1,AllowOutboundTrafficBetweenNodes,1580,Outbound,"192.168.0.84,192.168.0.85",*,"192.168.0.84,192.168.0.85",*,*,Allow,Allow HA traffic between nodes,,,,
Iaas-Test-Hub1-Rg,Iaas-Test-Hub1-Vnet1-Snet-Nsg-fwman1,AllowInboundTrafficBetweenNodes,1550,Inbound,"192.168.0.68,192.168.0.69",*,"192.168.0.68,192.168.0.69",*,*,Allow,Allow traffic between the nodes,Iaas-Test-Hub1-Vnet1-Snet-Nsg-fwman1,,,
Iaas-Test-Hub1-Rg,Iaas-Test-Hub1-Vnet1-Snet-Nsg-fwman1,AllowOutboundTrafficBetweenNodes,1560,Outbound,"192.168.0.68,192.168.0.69",*,"192.168.0.68,192.168.0.69",*,*,Allow,Allow traffic between the nodes,,,,
Iaas-Test-Hub1-Rg,Iaas-Test-Hub1-Vnet1-Snet-Nsg-fwpriv1,AllowvNetOutbound,1590,Outbound,*,*,VirtualNetwork,*,*,Allow,Allow traffic to enter and leave private interface (internet subnet routing),Iaas-Test-Hub1-Vnet1-Snet-Nsg-fwpriv1,,,
Iaas-Test-Hub1-Rg,Iaas-Test-Hub1-Vnet1-Snet-Nsg-fwpriv1,AllowvNetInbound,1600,Inbound,VirtualNetwork,*,*,*,*,Allow,Allow traffic to enter the private interface destined anywhere,,,,
Iaas-Test-Hub1-Rg,Iaas-Test-Hub1-Vnet1-Snet-Nsg-fwpub1,AllowInternetOutbound,1610,Outbound,"192.168.0.132,192.168.0.133,192.168.0.134",*,*,*,*,Allow,Allow all traffic leaving the firewall outside interface,Iaas-Test-Hub1-Vnet1-Snet-Nsg-fwpub1,,,
Iaas-Test-Hub1-Rg,Iaas-Test-Hub1-Vnet1-Snet-Nsg-fwpub1,DenyNonNattedTraffic,1620,Outbound,192.168.0.0/16,*,*,*,*,Deny,Deny any traffic that isn't natted behind the firewall,,,,
Iaas-Test-Hub1-Rg,Iaas-Test-Hub1-Vnet1-Snet-Nsg-fwpub1,DenyUnnecessaryPorts,100,Inbound,*,*,192.168.0.134,"3389,1433,1521,3306,445,23,110,123,5800,5900,25",*,Deny,This stops Azure warning that you have allow all inbound + extra ports,,,,
Iaas-Test-Hub1-Rg,Iaas-Test-Hub1-Vnet1-Snet-Nsg-fwpub1,AllowFirewallTrafficInbound,200,Inbound,*,*,192.168.0.134,*,*,Allow,Allow All traffic into firewall external interface,,,,
Iaas-Test-Hub1-Rg,Iaas-Test-Hub1-Vnet1-Snet-Nsg-management1,AllowManagementprotocolsfromJumpboxesOutbound,2300,Outbound,192.168.0.96/27,*,"192.168.0.0/23,10.10.0.0/22,10.0.0.0/23,10.8.0.0/22","3389,22,80,443,445",*,Allow,Allow Management from Jump Server,Iaas-Test-Hub1-Vnet1-Snet-Nsg-management1,,,
Iaas-Test-Hub1-Rg,Iaas-Test-Hub1-Vnet1-Snet-Nsg-management1,AllowSSHFromAnywhereInbound,200,Inbound,*,*,192.168.0.100,22,*,Allow,Allow Access to the SFTP server,,,,
Iaas-Test-Hub2-Rg,Iaas-Test-Hub2-Vnet1-Snet-Nsg-dc1,AllowAD-UDP-Traffic-Inbound,2100,Inbound,"10.0.0.0/23,10.8.0.0/22,10.112.124.10,192.168.0.0/23,10.10.0.0/22",*,10.0.0.196,"123,137,138",UDP,Allow,"Allow Windows Time,DFS, Group Policy,Netlogon",Iaas-Test-Hub2-Vnet1-Snet-Nsg-dc1,Iaas-Test-Hub2-Rg, Core-Test-St, Core-Test-Ws
Iaas-Test-Hub2-Rg,Iaas-Test-Hub2-Vnet1-Snet-Nsg-dc1,AllowAD-TCP-Traffic-Inbound,2110,Inbound,"10.0.0.0/23,10.8.0.0/22,10.112.124.10,192.168.0.0/23,10.10.0.0/22",*,10.0.0.196,"135,139,445,636,3268,6269,49152-65535",TCP,Allow,"Allow RPC, LDAP GC, LDAP GC SSL, LDAP SSL ,SMB, User/Computer Authentication",,,,
Iaas-Test-Hub2-Rg,Iaas-Test-Hub2-Vnet1-Snet-Nsg-dc1,AllowAD-TCP-UDP-Traffic-Inbound,2120,Inbound,"10.0.0.0/23,10.8.0.0/22,10.112.124.10,192.168.0.0/23,10.10.0.0/22",*,10.0.0.196,"464,389,53,88",*,Allow,"Allow Kerberos, LDAP,DNS.",,,,
Iaas-Test-Hub2-Rg,Iaas-Test-Hub2-Vnet1-Snet-Nsg-dc1,AllowAD-TCP-UDP-Traffic-Outbound,2130,Outbound,10.0.0.196,*,"10.0.0.0/23,10.8.0.0/22,10.112.124.10,192.168.0.0/23,10.10.0.0/22",*,*,Allow,Allow AD Servers to Initiate connections to Workloads.,,,,
Iaas-Test-Hub2-Rg,Iaas-Test-Hub2-Vnet1-Snet-Nsg-dc1,AllowManagementprotocolsfromJumpboxesInbound,2320,Inbound,"192.168.0.96/27,10.0.0.96/27",*,"192.168.0.0/23,10.10.0.0/22,10.0.0.0/23,10.8.0.0/22","3389,22,80,443,445",*,Allow,Allow Management from Jump Server,,,,
Iaas-Test-Hub2-Rg,Iaas-Test-Hub2-Vnet1-Snet-Nsg-fwha1,AllowInboundTrafficBetweenNodes,1570,Inbound,"10.0.0.84,10.0.0.85",*,"10.0.0.84,10.0.0.85",*,*,Allow,Allow HA traffic between nodes,Iaas-Test-Hub2-Vnet1-Snet-Nsg-fwha1,,,
Iaas-Test-Hub2-Rg,Iaas-Test-Hub2-Vnet1-Snet-Nsg-fwha1,AllowOutboundTrafficBetweenNodes,1580,Outbound,"10.0.0.84,10.0.0.85",*,"10.0.0.84,10.0.0.85",*,*,Allow,Allow HA traffic between nodes,,,,
Iaas-Test-Hub2-Rg,Iaas-Test-Hub2-Vnet1-Snet-Nsg-fwman1,AllowInboundTrafficBetweenNodes,1550,Inbound,"10.0.0.68,10.0.0.69",*,"10.0.0.68,10.0.0.69",*,*,Allow,Allow traffic between the nodes,Iaas-Test-Hub2-Vnet1-Snet-Nsg-fwman1,,,
Iaas-Test-Hub2-Rg,Iaas-Test-Hub2-Vnet1-Snet-Nsg-fwman1,AllowOutboundTrafficBetweenNodes,1560,Outbound,"10.0.0.68,10.0.0.69",*,"10.0.0.68,10.0.0.69",*,*,Allow,Allow traffic between the nodes,,,,
Iaas-Test-Hub2-Rg,Iaas-Test-Hub2-Vnet1-Snet-Nsg-fwpriv1,AllowvNetOutbound,1590,Outbound,*,*,VirtualNetwork,*,*,Allow,Allow traffic to enter and leave private interface (internet subnet routing),Iaas-Test-Hub2-Vnet1-Snet-Nsg-fwpriv1,,,
Iaas-Test-Hub2-Rg,Iaas-Test-Hub2-Vnet1-Snet-Nsg-fwpriv1,AllowvNetInbound,1600,Inbound,VirtualNetwork,*,*,*,*,Allow,Allow traffic to enter the private interface destined anywhere,,,,
Iaas-Test-Hub2-Rg,Iaas-Test-Hub2-Vnet1-Snet-Nsg-fwpub1,AllowInternetOutbound,1610,Outbound,"10.0.0.132,10.0.0.133,10.0.0.134",*,*,*,*,Allow,Allow all traffic leaving the firewall outside interface,Iaas-Test-Hub2-Vnet1-Snet-Nsg-fwpub1,,,
Iaas-Test-Hub2-Rg,Iaas-Test-Hub2-Vnet1-Snet-Nsg-fwpub1,DenyNonNattedTraffic,1620,Outbound,192.168.0.0/16,*,*,*,*,Deny,Deny any traffic that isn't natted behind the firewall,,,,
Iaas-Test-Hub2-Rg,Iaas-Test-Hub2-Vnet1-Snet-Nsg-fwpub1,DenyUnnecessaryPorts,100,Inbound,*,*,10.0.0.134,"3389,1433,1521,3306,445,23,110,123,5800,5900,25",*,Deny,This stops Azure warning that you have allow all inbound + extra ports,,,,
Iaas-Test-Hub2-Rg,Iaas-Test-Hub2-Vnet1-Snet-Nsg-fwpub1,AllowFirewallTrafficInbound,200,Inbound,*,*,10.0.0.134,*,*,Allow,Allow All traffic into firewall external interface,,,,
Iaas-Test-Hub2-Rg,Iaas-Test-Hub2-Vnet1-Snet-Nsg-management1,AllowManagementprotocolsfromJumpboxesOutbound,2300,Outbound,10.0.0.96/27,*,"192.168.0.0/23,10.10.0.0/22,10.0.0.0/23,10.8.0.0/22","3389,22,80,443,445",*,Allow,Allow Management from Jump Server,Iaas-Test-Hub2-Vnet1-Snet-Nsg-management1,,,
Iaas-Test-Hub2-Rg,Iaas-Test-Hub2-Vnet1-Snet-Nsg-management1,AllowSSHFromAnywhereInbound,200,Inbound,*,*,10.0.0.100,22,*,Allow,Allow Access to the SFTP server,,,,
Iaas-Test-Spoke1-Rg,Iaas-Test-Spoke1-Vnet1-Snet-Nsg-hpcman,AllowAnyToHPCWorkerOutbound,200,Outbound,10.10.0.0/27,*,10.10.0.32/27,*,*,Allow,Allow All traffic between the HPC Subnets,Iaas-Test-Spoke1-Vnet1-Snet-Nsg-hpcman,Iaas-Test-Spoke1-Rg, Core-Test-St, Core-Test-Ws
Iaas-Test-Spoke1-Rg,Iaas-Test-Spoke1-Vnet1-Snet-Nsg-hpcman,AllowAnyFromHPCWorkerInbound,210,Inbound,10.10.0.32/27,*,10.10.0.0/27,*,*,Allow,Allow All traffic between the HPC Subnets,,,,
Iaas-Test-Spoke1-Rg,Iaas-Test-Spoke1-Vnet1-Snet-Nsg-hpcworker,AllowAnyToHPCManOutbound,200,Outbound,10.10.0.32/27,*,10.10.0.0/27,*,*,Allow,Allow All traffic between the HPC Subnets,Iaas-Test-Spoke1-Vnet1-Snet-Nsg-hpcworker,,,
Iaas-Test-Spoke1-Rg,Iaas-Test-Spoke1-Vnet1-Snet-Nsg-hpcworker,AllowAnyFromHPCManInbound,210,Inbound,10.10.0.0/27,*,10.10.0.32/27,*,*,Allow,Allow All traffic between the HPC Subnets,,,,
Iaas-Test-Spoke1-Rg2,Iaas-Test-Spoke1-Vnet2-Snet-Nsg-hpcman,AllowAnyToHPCWorkerOutbound,200,Outbound,10.8.2.0/27,*,10.8.2.32/27,*,*,Allow,Allow All traffic between the HPC Subnets,Iaas-Test-Spoke1-Vnet2-Snet-Nsg-hpcman,Iaas-Test-Spoke1-Rg2, Core-Test-St, Core-Test-Ws
Iaas-Test-Spoke1-Rg2,Iaas-Test-Spoke1-Vnet2-Snet-Nsg-hpcman,AllowAnyFromHPCWorkerInbound,210,Inbound,10.8.2.32/27,*,10.8.2.0/27,*,*,Allow,Allow All traffic between the HPC Subnets,,,,
Iaas-Test-Spoke1-Rg2,Iaas-Test-Spoke1-Vnet2-Snet-Nsg-hpcworker,AllowAnyToHPCManOutbound,200,Outbound,10.8.2.32/27,*,10.8.2.0/27,*,*,Allow,Allow All traffic between the HPC Subnets,Iaas-Test-Spoke1-Vnet2-Snet-Nsg-hpcworker,,,
Iaas-Test-Spoke1-Rg2,Iaas-Test-Spoke1-Vnet2-Snet-Nsg-hpcworker,AllowAnyFromHPCManInbound,210,Inbound,10.8.2.0/27,*,10.8.2.32/27,*,*,Allow,Allow All traffic between the HPC Subnets,,,,
,nsg.all-member-server-subnets.csv,AllowAD-UDP-Traffic-Outbound,2200,Outbound,VirtualNetwork,*,"192.168.0.196,10.0.0.196,10.112.124.10","123,137,138",UDP,Allow,"Allow Windows Time,DFS, Group Policy,Netlogon",,,,
,nsg.all-member-server-subnets.csv,AllowAD-TCP-Traffic-Outbound,2210,Outbound,VirtualNetwork,*,"192.168.0.196,10.0.0.196,10.112.124.10","135,139,445,636,3268,6269,49152-65535",TCP,Allow,"Allow RPC, LDAP GC, LDAP GC SSL, LDAP SSL ,SMB, User/Computer Authentication",,,,
,nsg.all-member-server-subnets.csv,AllowAD-TCP-UDP-Traffic-Outbound,2220,Outbound,VirtualNetwork,*,"192.168.0.196,10.0.0.196,10.112.124.10","464,389,53,88",*,Allow,"Allow Kerberos, LDAP,DNS.",,,,
,nsg.all-member-server-subnets.csv,AllowAD-TCP-UDP-Traffic-Inbound,2230,Inbound,"192.168.0.196,10.0.0.196,10.112.124.10",*,VirtualNetwork,*,*,Allow,Trust Traffic from AD servers.,,,,
,nsg.all-member-server-subnets.csv,AllowAzureFileShareUKSAccessOutbound,2240,outbound,VirtualNetwork,*,Storage.UKSouth,445,tcp,Allow,Allow Member servers to access Azure File Share,,,,
,nsg.all-member-server-subnets.csv,AllowAzureFileShareUKWAccessOutbound,2250,outbound,VirtualNetwork,*,Storage.UKWest,445,tcp,Allow,Allow Member servers to access Azure File Share,,,,
,nsg.all-member-server-subnets.csv,AllowManagementprotocolsfromJumpboxesInbound,2310,Inbound,"192.168.0.96/27,10.0.0.96/27",*,"192.168.0.0/23,10.10.0.0/22,10.0.0.0/23,10.8.0.0/22","3389,22,80,443,445",*,Allow,Allow Management from Jump Server,,,,
,nsg.all-subnets.csv,AllowAzureLoadBalancerInBound,3000,Inbound,AzureLoadBalancer,*,VirtualNetwork,*,*,Allow,Allow Azure Load Balancer Health Probes,,,,
,nsg.all-subnets.csv,AllowHTTP-HTTPSOutbound,3010,Outbound,VirtualNetwork,*,Internet,"80,443",TCP,Allow,Allow Access to Internet via HTTP-HTTPS to URL whitelist on firewall,,,,
,nsg.all-subnets.csv,AllowAzureAgentOubound,3020,Outbound,VirtualNetwork,*,168.63.129.16,*,*,Allow,Allow VM Agent to Communicate Status with Azure,,,,
,nsg.all-subnets.csv,AllowVMtoAzureKMSOubound,3030,Outbound,VirtualNetwork,*,*,1688,TCP,Allow,Allow VM to Communicate with Azure KMS Server,,,,
,nsg.all-subnets.csv,AllowICMPOutbound,3040,Outbound,VirtualNetwork,*,*,*,ICMP,Allow,Allow outbound ping,,,,
,nsg.all-subnets.csv,DenyAnyOutbound,4000,Outbound,VirtualNetwork,*,*,*,*,Deny,Deny Any Outbound,,,,
,nsg.all-subnets.csv,DenyAnyInbound,4000,Inbound,*,*,*,*,*,Deny,Deny Any Inbound,,,,
